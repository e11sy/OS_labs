#include "File.hpp"
#include "Dir.hpp"
#include <iostream>
#include <string>
#include <cstdlib>
#include <ctime>

void clippySay(const std::string& message) {
    std::cout << "\n🤖 Clippy says: " << message << "\n";
}

void clippySayRandom() {
    std::string funComments[] = {
        "Ты уверен, что хочешь это сделать? Не можешь просто нажать 'Отмена'?",
        "Тебе точно нужно это копировать? Ты уверен, что не лучше удалить это в надежде, что забудешь?",
        "Этот файл явно не ожидал такого поворота событий...",
        "О, ты решил переместить файл. А как насчет 'удалить' для разнообразия?",
        "Как я люблю видеть твои неудачные попытки с файлами. Это почти как сериал с неожиданным поворотом!",
        "Ты пытаешься создать директорию? Серьезно? Кто вообще использует их, когда можно просто забросить все в 'Документы'?",
        "А ты уверен, что хочешь создать еще один файл? У тебя ведь уже есть 200 неоткрытых в папке!",
        "Пытаешься переместить файл? Пожалуйста, не говори, что ты собираешься его снова забыть.",
        "Восхитительно! Ты только что переименовал файл, а теперь не помнишь, что с ним делать. Шедевр!",
        "Зачем копировать файл, если можно просто нажать 'Отмена' и надеяться, что ничего не сломается?",
    };
    int idx = rand() % 10;
    clippySay(funComments[idx]);
}


void App::displayMenu() {

    std::cout << R"(
  $$$$$$\  $$\ $$\                                     $$\                 $$\                           $$\             $$\ 
$$  __$$\ $$ |\__|                                    \__|                $$ |                          $$ |            $$ |
$$ /  \__|$$ |$$\  $$$$$$\   $$$$$$\  $$\   $$\       $$\  $$$$$$$\       $$$$$$$\   $$$$$$\   $$$$$$$\ $$ |  $$\       $$ |
$$ |      $$ |$$ |$$  __$$\ $$  __$$\ $$ |  $$ |      $$ |$$  _____|      $$  __$$\  \____$$\ $$  _____|$$ | $$  |      $$ |
$$ |      $$ |$$ |$$ /  $$ |$$ /  $$ |$$ |  $$ |      $$ |\$$$$$$\        $$ |  $$ | $$$$$$$ |$$ /      $$$$$$  /       \__|
$$ |  $$\ $$ |$$ |$$ |  $$ |$$ |  $$ |$$ |  $$ |      $$ | \____$$\       $$ |  $$ |$$  __$$ |$$ |      $$  _$$<            
\$$$$$$  |$$ |$$ |$$$$$$$  |$$$$$$$  |\$$$$$$$ |      $$ |$$$$$$$  |      $$$$$$$  |\$$$$$$$ |\$$$$$$$\ $$ | \$$\       $$\ 
 \______/ \__|\__|$$  ____/ $$  ____/  \____$$ |      \__|\_______/       \_______/  \_______| \_______|\__|  \__|      \__|
                  $$ |      $$ |      $$\   $$ |                                                                            
                  $$ |      $$ |      \$$$$$$  |                                                                            
                  \__|      \__|       \______/                                                                             


                                                     .....                                                               
                                                 .=+++++++++=.                                                           
                                               :++*##%###%%#++=.                                                         
                                             .+*##*=:.    :=#*++:                                                        
                                            :+*#*-          -#*+=.                                                       
                                           :+*#+:            =%++:                                                       
                                         .:+*#*:             :#**-                                                       
                                     .*%@@@@@@*.             -#+*:                                                       
                                   .#@%#*#@@@@@+            .+*++.                                                       
                                        .**#*::             -#*+-                                                        
                                        -*##-           =@@@@%*+.                                                        
                                   :***++**+:         .:+@@@@@@%-.......                                                 
                                  ::.  ..:-=+-.    .::::---#%%%@@+-----------------------------::::::::..                
                                  :.:*@@@#-..==  .:::::-===###=:+%-::::::::::::::::::::::::::::::----:..                 
                                 .:.*@@@@@@=.:-...::-**===+++*-::::.....:::....::::::::::::::::::::::.                   
                                 .-:-%@@@@@-.::::::::. ..::..:=+-....:::::::.....::..................                    
                                  -+=:-=+-::--.....:...%@@@@%-.:=:........................:::.......                     
                                   .:=+*+++=:....:--:.:@@@@@@#.::............:::...................                      
                                     .#%#-.......:.:=-::*%@%*::-:............:---=====-::......:..                       
                                     :*#*:.....:::::.:=+=======:.......:::-====---::--==-:.......                        
                                     -*#*.....:........-%##=:.........:-==--:.......:-==-:...:..                         
                                     =*#+:..:-:........=#**........:-===-...........:-=-:......                          
                                    .+*##*#*-.......:..*#*=.......:-==:.........:.:-==-:......                           
                                   ..+*##*#+:.........:#**:..:=--=====-..........:-=-:.......                            
                                  ...+*##*#+....::....-#*+..:*#**==---:::::....:-==-:.......                             
                                 ...:+##**#=..........*#*=.:+#**=:............:======:......                             
                               .....:+##**#=.:........#**-.+#**+=-::.........:-=-..........                              
                              ....:.:*##*##=......::.-%**-+#**+====:......-=====-::.......                               
                             .......:*##*##-.........=%**+##*+====-.....:-========-::....                                
                            ........:*##*##=:........*#***#**+++=-:....:-========-:.....                                 
                          ........:::+##*##=.......::#***##++=-:......:-=======-:......                                  
                         .:......:...+###*#=........-#***#**=.........-==----:.....:...                                  
                       ........::....=*##*#+:.......+#+*+#*+-.......:---:.:-:.........                                   
                      ..:...........:=*#+*##=......-#**++#*+-......:---:-===:........                                    
                    .......:::.......:*#*-*#*+=-:.:*#**=+#*+:.....--------:......:..                                     
                  ..:.................*#*:.=*#######**=--#++:...:-==----:..........                                      
                .........::...........+##-....:-=++++=:.-#++:..:-====-:............                                      
              .....:....:....::.......-*#+:....:=====:..-#++::-------.............                                       
           ..::.......::.........::...:+#*-..:-=====-...-#++===----:.............                                        
        ..::.....::::.......:.........:=##+::-==--=+====+#++=-:---:.............                                         
         ....:::::....::........:......:+#*====-:.:-----+*++::---:.............                                          
              ...:::......::........::..-*#*++=:::....:-#*+=--=-:.............                                           
                 ....::::.....:::......::-+#*+=----==+##*+=---:..............                                            
                      ...::::......:::....:=+**####**+**++=-:...............                                             
                           ...:::......::::::-=+****+=--::.................                                              
                               ...:::::...::::::::....::..................                                               
                                   ...:::::..::::::......................                                                
                                        ...::::......:::.........::.....                                                 
                                            ..........................                                                   

)" << std::endl;

    clippySay("Ready to manage some files like a boss!");

    std::cout << "\nFilesystem Manager Menu:\n";
    std::cout << "1. List Logical Drives\n";
    std::cout << "2. Show Drive Info\n";
    std::cout << "3. Create Directory\n";
    std::cout << "4. Remove Directory\n";
    std::cout << "5. Create File\n";
    std::cout << "6. Copy File\n";
    std::cout << "7. Move File\n";
    std::cout << "8. Show File Attributes\n";
    std::cout << "9. Modify File Attributes\n";
    std::cout << "0. Exit\n";
    std::cout << "Enter your choice: ";
}

void App::handleInput() {
    int choice;
    std::cin >> choice;
    std::cin.ignore();

    switch (choice) {
        case 1: 
            listDrives(); 
            clippySayRandom(); 
            break;
        case 2: 
            showDriveInfo(); 
            clippySayRandom(); 
            break;
        case 3: 
            createDirectory(); 
            clippySayRandom(); 
            break;
        case 4: 
            removeDirectory(); 
            clippySayRandom(); 
            break;
        case 5: 
            createFile(); 
            clippySayRandom(); 
            break;
        case 6: 
            copyFile(); 
            clippySayRandom(); 
            break;
        case 7: 
            moveFile(); 
            clippySayRandom(); 
            break;
        case 8: 
            showFileAttributes(); 
            clippySayRandom(); 
            break;
        case 9: 
            modifyFileAttributes(); 
            clippySayRandom(); 
            break;
        case 0: 
            clippySay("Exiting... Until next time!"); 
            exit(0);
        default: 
            clippySay("Oops, that's not a valid choice! Try again.");
            break;
    }
}

void App::createFile() {
    std::string path;
    std::cout << "Enter file path to create: ";
    std::getline(std::cin, path);
    fileHelper.createFile(path);
    clippySay("Nice, another file added to the chaos!");
}

void App::copyFile() {
    std::string source, destination;
    std::cout << "Enter source file path: ";
    std::getline(std::cin, source);
    std::cout << "Enter destination file path: ";
    std::getline(std::cin, destination);
    fileHelper.copyFile(source, destination);
    clippySay("I hope you didn't just copy an empty file... did you?");
}

void App::moveFile() {
    std::string source, destination;
    std::cout << "Enter source file path: ";
    std::getline(std::cin, source);
    std::cout << "Enter destination file path: ";
    std::getline(std::cin, destination);
    fileHelper.moveFile(source, destination);
    clippySay("Like a file ninja... moved without a trace.");
}

int main() {
    srand(time(0));  // Initialize random number generator for Clippy's responses
    App app;
    app.run();
    return 0;
}
